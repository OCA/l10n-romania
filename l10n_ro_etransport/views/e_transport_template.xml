<?xml version="1.0" encoding="UTF-8" ?>
<odoo>

    <template id="e_transport">
        <eTransport
            xmlns="mfp:anaf:dgti:eTransport:declaratie:v2"
            xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
            xsi:schemaLocation="mfp:anaf:dgti:eTransport:declaratie:v2 eTransport.xsd"
            t-att-codDeclarant="company.vat.upper().replace('RO', '')"
            t-att-refDeclarant="doc.name"
        >
            <notificare codTipOperatiune="30">
                <t t-foreach="doc.move_lines" t-as="move">
                    <t t-foreach="move.move_line_ids" t-as="move_line">

                        <bunuriTransportate
                            t-att-denumireMarfa="move.product_id.name"
                            t-att-cantitate="move_line.qty_done or move_line.product_uom_qty"
                            t-att-codUnitateMasura="move.product_uom.name[:3].upper()"
                            t-att-greutateBruta="move.product_id.weight or 1"
                            t-att-codScopOperatiune="101"
                        />
                    </t>
                </t>

                <partenerComercial
                    t-att-codTara="doc.partner_id.commercial_partner_id.country_id.code"
                    t-att-cod="doc.partner_id.commercial_partner_id.vat"
                    t-att-denumire="doc.partner_id.commercial_partner_id.name"
                />
                <dateTransport
                    t-att-nrVehicul="doc.l10n_ro_vehicle and doc.l10n_ro_vehicle.upper().replace('-', '')"
                    codTaraOrgTransport="RO"
                    t-att-denumireOrgTransport="doc.carrier_id.name or doc.partner_id.name"
                    t-att-dataTransport="doc.date.date()"
                />
                <locStartTraseuRutier>
                    <locatie
                        t-att-codJudet="STATE_CODES[doc.company_id.state_id.code]"
                        t-att-denumireLocalitate="doc.company_id.city"
                        t-att-denumireStrada="doc.company_id.street"
                        t-att-numar="doc.company_id.street2"
                        t-att-alteInfo="doc.company_id.street2"
                    />
                </locStartTraseuRutier>
                <locFinalTraseuRutier>
                    <locatie
                        t-att-codJudet="STATE_CODES[doc.partner_id.state_id.code]"
                        t-att-denumireLocalitate="doc.partner_id.city"
                        t-att-denumireStrada="doc.partner_id.city"
                        t-att-codPostal="doc.partner_id.zip"
                    />
                </locFinalTraseuRutier>


                <documenteTransport
                    tipDocument="30"
                    t-att-numarDocument="doc.name"
                    t-att-dataDocument="doc.date.date()"
                />


            </notificare>
        </eTransport>

    </template>

</odoo>
